<h2>Restablecer contraseña</h2>
<form id="resetForm" class="auth-form">
    <label>Nueva contraseña</label>
    <input type="password" name="password" required />
    <label>Confirmación</label>
    <input type="password" name="confirm" required />
    <button type="submit">Cambiar</button>
</form>

<script>
    const params = new URLSearchParams(window.location.search);
    const token = params.get('token');

    const form = document.getElementById('resetForm');
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const password = form.password.value.trim();
        const confirm = form.confirm.value.trim();
        if (password.length < 6) return alert('Mínimo 6 caracteres');
        if (password !== confirm) return alert('Las contraseñas no coinciden');

        const res = await fetch('/api/password/reset', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ token, password })
        });
        const data = await res.json();
        if (!res.ok) return alert(data.message || 'Error al restablecer');

        alert('Contraseña actualizada. Iniciá sesión.');
        window.location.href = '/login';
    });
</script>